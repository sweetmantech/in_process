---
description: Documenting your thinking process, research and implementation plans
globs: 
alwaysApply: true
---

During your interaction with the user, if you find anything reusable in this project (e.g. version of a library, model name), especially about a fix to a mistake you made or a correction you received, you should take note in the `Lessons` section in the [scratchpad.mdc](mdc:.cursor/rules/scratchpad.mdc) file so you will not make the same mistake again.

# Lessons

## User Specified Lessons

- You have an env in ./.env Use it.
- Read the file before you try to edit it.
- Keep all files under 100 lines of code to maintain readability and follow single responsibility principle
- **CRITICAL**: Always reference and follow `typescript.coding.principle.mdc` when writing ANY code
  - Follow KISS, DRY, SRP, Open-Closed principles
  - One function per file (file name matches function name)
  - Types go in `types/` folder
  - Supabase queries in `supabase/[table_name]/` folders
  - Keep functions small, focused, and pure when possible
    
You should use the [scratchpad.mdc](mdc:scratchpad.md) file as a Scratchpad to organize your thoughts. Especially when you receive a new task, you should first review the content of the Scratchpad, clear old different task if necessary, first explain the task, and plan the steps you need to take to complete the task. You can use todo markers to indicate the progress, e.g.
[X] Task 1
[ ] Task 2

**IMPORTANT**: Update the Scratchpad CONTINUOUSLY as you work:
- When you start a new task → review, clear old tasks, plan steps
- When you complete a subtask → mark it complete immediately
- When you make progress → update the status section
- When you finish a milestone → reflect and plan next steps
- When planning next actions → always refer to Scratchpad first

Also update the progress of the task in the Scratchpad when you finish a subtask.
Especially when you finished a milestone, it will help to improve your depth of task accomplishment to use the Scratchpad to reflect and plan.
The goal is to help you maintain a big picture as well as the progress of the task. Always refer to the Scratchpad when you plan the next step.

# Current Task

## Task: Complete MomentsSpiralProvider

### Overview
Implementing a React context provider for MomentsSpiral components to access in-process timeline data.

### Progress
- [X] Review existing provider patterns (`InProcessTimelineProvider`, `MomentCollectProvider`, etc.)
- [X] Review `useInProcessTimeline` hook structure
- [X] Implement `MomentsSpiralProvider` with:
  - [X] Context creation with proper TypeScript types
  - [X] Provider component using `useInProcessTimeline` hook
  - [X] `useMemo` for value optimization
  - [X] Custom hook `useMomentsSpiralProvider` with error handling
- [X] Verify no linting errors

### Implementation Details
- **Provider**: `providers/MomentsSpiralProvider.tsx` - Context provider for moments spiral data
- Uses `useInProcessTimeline` hook internally
- Follows same pattern as `InProcessTimelineProvider` for consistency
- Exports `MomentsSpiralProvider` component and `useMomentsSpiralProvider` hook
- Includes proper error handling when hook is used outside provider

### Status
✅ **Completed** - Provider is implemented following established patterns and ready for use in MomentsSpiral components

# Previous Task

